(this["webpackJsonpjumbo-hooks"]=this["webpackJsonpjumbo-hooks"]||[]).push([[45],{1368:function(e,t,a){"use strict";a.r(t);var n=a(32),r=a.n(n),i=a(105),c=a(9),l=a(0),o=a.n(l),s=a(480),u=a(50),m=a(3),d=a(487),p=a(467),g=a(445),f=a(656),h=a(502),b=a(965),v=a(448),j=a(29),y=a(440),E=a(437),_=a(441),N=a(465),O=a(27),k=a(14),S=a(446),w=a(490),x=a.n(w),C=a(499),P=a.n(C),T=a(447);t.default=function(e){var t=Object(l.useState)(""),a=Object(c.a)(t,2),n=a[0],w=a[1],C=Object(l.useState)(!1),M=Object(c.a)(C,2),I=M[0],R=M[1],z=Object(l.useState)(e.location.state?e.location.state.customer_id:""),D=Object(c.a)(z,2),L=D[0],A=D[1],J=Object(l.useState)(e.location.state?e.location.state.project_id:""),F=Object(c.a)(J,2),B=F[0],U=F[1],W=Object(l.useState)(e.location.state?e.location.state.room_id:""),H=Object(c.a)(W,2),G=H[0],Y=H[1],K=Object(l.useState)([]),q=Object(c.a)(K,2),Q=q[0],V=q[1],X=Object(l.useState)(new Date),Z=Object(c.a)(X,2),$=Z[0],ee=Z[1],te=Object(l.useState)(""),ae=Object(c.a)(te,2),ne=ae[0],re=ae[1],ie=Object(l.useState)(""),ce=Object(c.a)(ie,2),le=ce[0],oe=ce[1],se=Object(l.useState)(null),ue=Object(c.a)(se,2),me=ue[0],de=ue[1],pe=Object(l.useState)(""),ge=Object(c.a)(pe,2),fe=ge[0],he=ge[1],be=Object(l.useState)(0),ve=Object(c.a)(be,2),je=ve[0],ye=ve[1],Ee=Object(l.useState)([]),_e=Object(c.a)(Ee,2),Ne=_e[0],Oe=_e[1],ke=Object(l.useState)([]),Se=Object(c.a)(ke,2),we=Se[0],xe=Se[1],Ce=Object(l.useState)([]),Pe=Object(c.a)(Ce,2),Te=Pe[0],Me=Pe[1],Ie=Object(l.useState)([]),Re=Object(c.a)(Ie,2),ze=Re[0],De=Re[1],Le=Object(O.g)(),Ae=Object(k.e)((function(e){return e.settings})).width,Je=Object(l.useState)(!1),Fe=Object(c.a)(Je,2),Be=Fe[0],Ue=Fe[1];Object(l.useEffect)((function(){j.a.get(j.b+"task/getTaskInfo",{params:{id:n}}).then((function(e){if(Oe(e.data.customer),xe(e.data.project),De(e.data.room),Me(e.data.assign_to),n)if(A(e.data.task.company_id),U(e.data.task.project_id),Y(e.data.task.room_id),V(e.data.task.assign_to),re(e.data.task.task),oe(e.data.task.description),ye(e.data.task.priority),ee(new Date(e.data.task.due_by_date)),localStorage.getItem("pixie_room_id")){var t=localStorage.getItem("pixie_room_id"),a=localStorage.getItem("pixie_data");if(n===t){for(var r=a.split(","),i=r[0].match(/:(.*?);/)[1],c=atob(r[1]),l=c.length,o=new Uint8Array(l);l--;)o[l]=c.charCodeAt(l);var s=JSON.parse(localStorage.getItem("user")).id+"-"+(new Date).getTime()+"-pixie."+i.split("/").pop(),u=new File([o],s,{type:i});de(u),he(URL.createObjectURL(u))}localStorage.removeItem("pixie_room_id"),localStorage.removeItem("pixie_id"),localStorage.removeItem("pixie_data")}else he(me?j.c+"upload/img/"+me:"");R(!0)})).catch((function(e){Ue(!0)}))}),[n]);var We=function(e){var t=n||JSON.parse(localStorage.getItem("user")).id+"_"+(new Date).getTime();navigator.onLine||caches.open("SirvezApp").then((function(e){var a=null;me&&(a=(new Date).getTime()+"-"+fe,e.put("/upload/file/"+a,new Response(me)));var n,r="/api/task/taskList?customer_id="+L,i="/api/task/taskList?project_id="+B,c="/api/task/taskList?project_id="+B+"&room_id="+G,l={id:t,account_manager:JSON.parse(localStorage.getItem("user")).first_name,archived:0,archived_day:null,building_name:null,company_id:L,company_name:Ne.filter((function(e){return e.id==L}))[0].name,created_at:"",created_by:JSON.parse(localStorage.getItem("user")).id,description:le,due_by_date:$.getFullYear()+"-"+($.getMonth()+1)+"-"+$.getDate(),favourite:null,floor_name:null,priority:je,profile_pic:JSON.parse(localStorage.getItem("user")).profile_pic,project_id:B,project_name:we.filter((function(e){return e.id==B}))[0].project_name,room_id:G,room_number:ze.filter((function(e){return e.id==G}))[0].room_number,site_id:null,site_name:null,task:ne,task_img:a,updated_at:"",updated_by:null};e.match("/api/task/taskList").then((function(e){return e?e.json():null})).then((function(t){if(null!=t){n=t,t.tasks.unshift(l);var a=new Response(JSON.stringify(t),{headers:{"content-type":"application/json"}});e.put("/api/task/taskList",a.clone()),e.match(r).then((function(e){return e?e.json():null})).then((function(t){null==t&&((t=n).tasks=[]),t.tasks.unshift(l);var a=new Response(JSON.stringify(t),{headers:{"content-type":"application/json"}});e.put(r,a.clone())})),e.match(i).then((function(e){return e?e.json():null})).then((function(t){null==t&&((t=n).tasks=[]),t.tasks.unshift(l);var a=new Response(JSON.stringify(t),{headers:{"content-type":"application/json"}});e.put(i,a.clone())})),e.match(c).then((function(e){return e?e.json():null})).then((function(t){null==t&&((t=n).tasks=[]),t.tasks.unshift(l);var a=new Response(JSON.stringify(t),{headers:{"content-type":"application/json"}});e.put(c,a.clone())}))}}))}));var a=new FormData;a.append("id",t),a.append("company_id",L),a.append("project_id",B),a.append("room_id",G),a.append("assign_to",JSON.stringify(Q)),a.append("task",ne),a.append("description",le),a.append("task_img",me),a.append("priority",je),a.append("due_by_date",$.getFullYear()+"-"+($.getMonth()+1)+"-"+$.getDate()),j.a.post(j.b+"task/updateTask",a).then((function(a){if("success"===a.data.status)if(1!=e){var n=we.find((function(e){return e.id==B})).project_name,r=ze.find((function(e){return e.id==G})).room_number;Le.push({pathname:"/app/project/live/".concat(n,"/").concat(r)})}else w(a.data.task.id),Ye(a.data.task.id);else"error"===a.data.status&&(1!=e||navigator.onLine||Ye(t),u.NotificationManager.error(a.data.msg,"Error!",1e3,(function(){})))})).catch((function(e){u.NotificationManager.error(e,"Error!",1e3,(function(){}))}))},He=function(e){return new Promise((function(t){P.a.imageFileResizer(e,500,500,"JPEG",100,0,(function(e){t(e)}),"blob")}))},Ge=function(){var e=Object(i.a)(r.a.mark((function e(t){var a,n,i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.target.files[0],e.next=3,He(a);case 3:n=e.sent,i=a.name,a=new File([n],i,n),he(URL.createObjectURL(a)),de(a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ye=function(e){We(1),localStorage.setItem("isFirst",0),Le.push({pathname:"/app/project/sticker",state:{room_id:e,img_id:e,img_url:fe,img_file:me}})};return o.a.createElement("div",{className:"app-wrapper"},o.a.createElement(s.a,{match:e.match,title:o.a.createElement(m.a,{id:"sidebar.taskmanager.addnew"})}),I?o.a.createElement("div",{className:"row"},o.a.createElement(d.a,{styleName:"col-12"},o.a.createElement("form",{className:"row",autoComplete:"off"},o.a.createElement("div",{className:"col-12"},o.a.createElement(p.a,{id:"task",label:"Task",value:ne,onChange:function(e){return re(e.target.value)},margin:"normal",helperText:"Please Enter Task",fullWidth:!0})),o.a.createElement("div",{className:"col-md-6 col-12"},o.a.createElement(p.a,{id:"customer",select:!0,label:"Customer",value:L,onChange:function(e){return A(e.target.value)},SelectProps:{},helperText:"Please select Customer",margin:"normal",fullWidth:!0},Ne.map((function(e){return o.a.createElement(v.a,{key:e.id,value:e.id},e.name)})))),o.a.createElement("div",{className:"col-md-6 col-12"},o.a.createElement(p.a,{id:"project",select:!0,label:"Project",value:B,onChange:function(e){return U(e.target.value)},SelectProps:{},helperText:"Please select Project",margin:"normal",fullWidth:!0},we.filter((function(e){return e.company_id==L})).map((function(e){return o.a.createElement(v.a,{key:e.id,value:e.id},e.project_name)})))),o.a.createElement("div",{className:"col-md-6 col-12"},o.a.createElement(p.a,{id:"room",select:!0,label:"Room",value:G,onChange:function(e){return Y(e.target.value)},SelectProps:{},helperText:"Please select Room",margin:"normal",fullWidth:!0},ze.filter((function(e){return e.project_id==B})).map((function(e){return o.a.createElement(v.a,{key:e.id,value:e.id},e.room_number)})))),o.a.createElement("div",{className:"col-md-6 col-12 d-flex align-items-center"},o.a.createElement(y.a,{className:"w-100"},o.a.createElement(_.a,{htmlFor:"name-multiple"},"Assign To"),o.a.createElement(N.a,{multiple:!0,value:Q,onChange:function(e){return V(e.target.value)},input:o.a.createElement(E.a,{id:"assign-to"}),MenuProps:{PaperProps:{style:{maxHeight:224,width:200}}}},Te.map((function(e){return o.a.createElement(v.a,{key:e.id,value:""+e.id,style:{fontWeight:-1!==Q.indexOf(Te)?"500":"400"}},e.first_name)}))))),o.a.createElement("div",{className:"col-6 d-flex align-items-center"},o.a.createElement(h.a,{utils:f.a},o.a.createElement(b.a,{margin:"normal",id:"date-picker-dialog",label:"Due by Date",format:"MM/dd/yyyy",value:$,onChange:ee,KeyboardButtonProps:{"aria-label":"change date"},helperText:"Please Enter Due by Date"}))),o.a.createElement("div",{className:"col-md-6 col-12"},o.a.createElement(p.a,{id:"priority",select:!0,label:"Snagging ",value:je,onChange:function(e){return ye(e.target.value)},SelectProps:{},helperText:"Please select Snagging ",margin:"normal",fullWidth:!0},[{id:0,content:"Low"},{id:1,content:"High"}].map((function(e){return o.a.createElement(v.a,{key:e.id,value:e.id},e.content)})))),o.a.createElement("div",{className:"col-12"},o.a.createElement(p.a,{id:"multiline-flexible",label:"Task Description",multiline:!0,rowsMax:"4",value:le,onChange:function(e){return oe(e.target.value)},margin:"normal",fullWidth:!0})),o.a.createElement("div",{className:"col-12 text-center mt-4 mb-4"},o.a.createElement("input",{type:"file",id:"upload_doc",accept:"image/*",name:"upload_doc",style:{display:"none"},onChange:function(e){Ge(e)}}),o.a.createElement(g.a,{className:"jr-btn w-100",color:"primary",variant:"contained",onClick:function(e){document.getElementById("upload_doc").click()}},o.a.createElement("i",{className:"zmdi zmdi-camera zmdi-hc-2x animated infinite pulse"}))),fe?o.a.createElement("div",{className:"col-12"},o.a.createElement("div",{className:"jr-card pb-2"},o.a.createElement("div",{className:"jr-card-thumb"},o.a.createElement("img",{className:"card-img-top img-fluid",alt:"products",src:fe})),o.a.createElement("div",{className:"jr-card-social text-center"},o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-xl-6 col-lg-6 col-md-6 col-6"},o.a.createElement(T.a,{className:"jr-fab-btn bg-light-blue accent-2 text-white",onClick:function(){return We(1)}},o.a.createElement("i",{className:"zmdi zmdi-puzzle-piece zmdi-hc-2x"}))),o.a.createElement("div",{className:"col-xl-6 col-lg-6 col-md-6 col-6"},o.a.createElement(T.a,{className:"jr-fab-btn bg-red accent-2 text-white",onClick:function(){de(null),he("")}},o.a.createElement("i",{className:"zmdi zmdi-delete zmdi-hc-2x"}))))))):null,o.a.createElement("div",{className:"col-md-12 col-12 text-right"},o.a.createElement(g.a,{variant:"contained",color:"primary",className:"jr-btn",onClick:function(){return We()}},"Save"))))):o.a.createElement("div",{className:"loader-view",style:{height:Ae>=1200?"calc(100vh - 259px)":"calc(100vh - 238px)"}},o.a.createElement(S.a,null)),o.a.createElement(x.a,{show:Be,warning:!0,confirmBtnText:"Go Back",confirmBtnBsStyle:"danger",cancelBtnBsStyle:"default",title:"Warning!",onConfirm:function(){return Le.go(-1)}},"Data not cached, so you can not view this page."),o.a.createElement(u.NotificationContainer,null))}},480:function(e,t,a){"use strict";var n=a(0),r=a.n(n),i=a(529),c=a(530),l=function(e,t,a){return 0===a?"/":"/"+e.split(t)[0]+t};t.a=function(e){var t=e.title,a=e.match,n=e.project_name,o=e.room_number,s=[],u=a.url.substr(1),m=u.split("/");return m.map((function(e,t){""===e&&m.splice(t,1),"live"===m[t-1]?s[t]=n||"":"live"===m[t-2]?s[t]=o||"":s[t]=e})),r.a.createElement("div",{className:"page-heading d-sm-flex justify-content-sm-between align-items-sm-center"},r.a.createElement("h2",{className:"title mb-3 mb-sm-0"},t),r.a.createElement(i.a,{className:"mb-0",tag:"nav"},m.map((function(e,t){if(0!=t)return r.a.createElement(c.a,{active:m.length===t+1,tag:m.length===t+1?"span":"a",key:t,href:l(u,e,t)},function(e){var t=e.split("-");return t.length>1?t[0].charAt(0).toUpperCase()+t[0].slice(1)+" "+t[1].charAt(0).toUpperCase()+t[1].slice(1):e.charAt(0).toUpperCase()+e.slice(1)}(s[t]))}))))}},487:function(e,t,a){"use strict";var n=a(0),r=a.n(n),i=function(e){var t=e.heading,a=e.children,n=e.styleName,i=e.cardStyle,c=e.childrenStyle,l=e.headerOutside,o=e.headingStyle;return r.a.createElement("div",{className:"".concat(n)},l&&r.a.createElement("div",{className:"jr-entry-header"},r.a.createElement("h3",{className:"entry-heading"},t),a.length>1&&r.a.createElement("div",{className:"entry-description"},a[0])),r.a.createElement("div",{className:"jr-card ".concat(i)},!l&&t&&r.a.createElement("div",{className:"jr-card-header ".concat(o)},r.a.createElement("h3",{className:"card-heading"},t),a.length>1&&r.a.createElement("div",{className:"sub-heading"},a[0])),r.a.createElement("div",{className:"jr-card-body ".concat(c)},a.length>1?a[1]:a)))};t.a=i,i.defaultProps={cardStyle:"",headingStyle:"",childrenStyle:"",styleName:"col-lg-6 col-sm-12"}},499:function(e,t){e.exports=function(e){var t={};function a(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,a),r.l=!0,r.exports}return a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=0)}([function(e,t,a){"use strict";function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}a.r(t);var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,a;return t=e,a=[{key:"changeHeightWidth",value:function(e,t,a,n,r,i){return a>n&&(e=Math.round(e*n/a),a=n),e>t&&(a=Math.round(a*t/e),e=t),r&&a<r&&(e=Math.round(e*r/a),a=r),i&&e<i&&(a=Math.round(a*i/e),e=i),{height:e,width:a}}},{key:"resizeAndRotateImage",value:function(e,t,a,n,r){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"jpeg",c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:100,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,o=c/100,s=document.createElement("canvas"),u=e.width,m=e.height,d=this.changeHeightWidth(m,a,u,t,n,r);!l||90!==l&&270!==l?(s.width=d.width,s.height=d.height):(s.width=d.height,s.height=d.width),u=d.width,m=d.height;var p=s.getContext("2d");return l&&(p.rotate(l*Math.PI/180),90===l?p.translate(0,-s.width):180===l?p.translate(-s.width,-s.height):270===l?p.translate(-s.height,0):0!==l&&360!==l||p.translate(0,0)),p.drawImage(e,0,0,u,m),s.toDataURL("image/".concat(i),o)}},{key:"b64toBlob",value:function(e,t){t=t||"image/jpeg";for(var a=atob(e.toString().replace(/^data:image\/(png|jpeg|jpg);base64,/,"")),n=[],r=0;r<a.length;r+=512){for(var i=a.slice(r,r+512),c=new Array(i.length),l=0;l<i.length;l++)c[l]=i.charCodeAt(l);var o=new Uint8Array(c);n.push(o)}return new Blob(n,{type:t})}},{key:"createResizedImage",value:function(t,a,n,r,i,c,l){var o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"base64",s=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,u=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,m=null,d=new FileReader;t?(d.readAsDataURL(t),d.onload=function(){var t=new Image;t.src=d.result,t.onload=function(){var d=e.resizeAndRotateImage(t,a,n,s,u,r,i,c);m=e.b64toBlob(d,"image/".concat(r)),l("blob"===o?m:d)}},d.onerror=function(e){l(e)}):l("File Not Found")}}],null&&n(t.prototype,null),a&&n(t,a),e}();t.default={imageFileResizer:function(e,t,a,n,i,c,l,o,s,u){return r.createResizedImage(e,t,a,n,i,c,l,o,s,u)}}}])},529:function(e,t,a){"use strict";var n=a(1),r=a(22),i=a(0),c=a.n(i),l=a(2),o=a.n(l),s=a(54),u=a.n(s),m=a(18),d={tag:m.m,listTag:m.m,className:o.a.string,listClassName:o.a.string,cssModule:o.a.object,children:o.a.node,"aria-label":o.a.string},p=function(e){var t=e.className,a=e.listClassName,i=e.cssModule,l=e.children,o=e.tag,s=e.listTag,d=e["aria-label"],p=Object(r.a)(e,["className","listClassName","cssModule","children","tag","listTag","aria-label"]),g=Object(m.i)(u()(t),i),f=Object(m.i)(u()("breadcrumb",a),i);return c.a.createElement(o,Object(n.a)({},p,{className:g,"aria-label":d}),c.a.createElement(s,{className:f},l))};p.propTypes=d,p.defaultProps={tag:"nav",listTag:"ol","aria-label":"breadcrumb"},t.a=p},530:function(e,t,a){"use strict";var n=a(1),r=a(22),i=a(0),c=a.n(i),l=a(2),o=a.n(l),s=a(54),u=a.n(s),m=a(18),d={tag:m.m,active:o.a.bool,className:o.a.string,cssModule:o.a.object},p=function(e){var t=e.className,a=e.cssModule,i=e.active,l=e.tag,o=Object(r.a)(e,["className","cssModule","active","tag"]),s=Object(m.i)(u()(t,!!i&&"active","breadcrumb-item"),a);return c.a.createElement(l,Object(n.a)({},o,{className:s,"aria-current":i?"page":void 0}))};p.propTypes=d,p.defaultProps={tag:"li"},t.a=p}}]);
//# sourceMappingURL=45.7651de9d.chunk.js.map