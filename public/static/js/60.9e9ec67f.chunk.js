(this["webpackJsonpjumbo-hooks"]=this["webpackJsonpjumbo-hooks"]||[]).push([[60],{1340:function(e,t,a){"use strict";a.r(t);var n=a(9),o=a(0),l=a.n(o),r=a(480),i=a(3),c=a(1370),s=a(1374),m=a(1373),d=a(1375),u=a(1371),f=a(1393),p=a(1372),g=a(1392),h=a(450),b=a(255),v=a(404),E=a(1391),N=a(532),j=a.n(N),w=a(851),_=a(67),O=a(14),y=a(27),x=a(446),S=a(29),C=a(1390),k=a(1376),R=a(572),I=a.n(R),D=a(467),M=a(448),P=a(445),z=a(447),J=a(50),A=a(490),F=a.n(A),T=[{id:"id",align:!1,disablePadding:!0,label:"ID"},{id:"room_name",align:!0,disablePadding:!1,label:"Name"},{id:"department_name",align:!0,disablePadding:!1,label:"Department"},{id:"actions",align:!0,disablePadding:!1,numeric:"right",label:"Actions"}];t.default=function(e){var t=e.location.state?e.location.state.building_id:null,a=e.location.state?e.location.state.site_id:null,N=e.location.state?e.location.state.id:null,R=Object(o.useState)(!1),A=Object(n.a)(R,2),B=A[0],L=A[1],U=Object(o.useState)(!1),W=Object(n.a)(U,2),H=W[0],V=W[1],G=Object(o.useState)("asc"),Y=Object(n.a)(G,2),q=Y[0],K=Y[1],Q=Object(o.useState)("id"),X=Object(n.a)(Q,2),Z=X[0],$=X[1],ee=Object(o.useState)(!1),te=Object(n.a)(ee,2),ae=te[0],ne=te[1],oe=Object(O.e)((function(e){return e.settings})).width,le=Object(y.g)(),re=Object(o.useState)(0),ie=Object(n.a)(re,2),ce=ie[0],se=ie[1],me=Object(o.useState)(10),de=Object(n.a)(me,2),ue=de[0],fe=de[1],pe=Object(o.useState)([]),ge=Object(n.a)(pe,2),he=ge[0],be=ge[1],ve=Object(o.useState)(""),Ee=Object(n.a)(ve,2),Ne=Ee[0],je=Ee[1],we=Object(o.useState)([]),_e=Object(n.a)(we,2),Oe=_e[0],ye=_e[1],xe=Object(o.useState)(null),Se=Object(n.a)(xe,2),Ce=Se[0],ke=Se[1],Re=Object(o.useState)("https://via.placeholder.com/300x300"),Ie=Object(n.a)(Re,2),De=Ie[0],Me=Ie[1],Pe=Object(o.useState)([]),ze=Object(n.a)(Pe,2),Je=ze[0],Ae=ze[1],Fe=Object(o.useState)(""),Te=Object(n.a)(Fe,2),Be=Te[0],Le=Te[1],Ue=Object(o.useState)(""),We=Object(n.a)(Ue,2),He=We[0],Ve=We[1],Ge=Object(o.useState)([]),Ye=Object(n.a)(Ge,2),qe=Ye[0],Ke=Ye[1],Qe=Object(o.useState)(""),Xe=Object(n.a)(Qe,2),Ze=Xe[0],$e=Xe[1],et=Object(o.useState)(!1),tt=Object(n.a)(et,2),at=tt[0],nt=tt[1];Object(o.useEffect)((function(){S.a.get(S.b+"floor/floorInfo",{params:{id:N}}).then((function(e){be(e.data.rooms),Ae(e.data.rooms),ye(e.data.floor),ne(!0)})).catch((function(e){nt(!0)}))}),[N]);var ot=function(){S.a.get(S.b+"floor/floorInfo",{params:{id:N}}).then((function(e){be(e.data.rooms),Ae(e.data.rooms),ye(e.data.floor),ne(!0)})).catch((function(e){nt(!0)}))},lt=function(e,t){var a;"desc"===(a=Z===t&&"asc"===q?"desc":"asc")?Je.sort((function(e,a){return a[t]<e[t]?-1:1})):Je.sort((function(e,a){return e[t]<a[t]?-1:1})),K(a),$(t)},rt=function(e,a){if(0===a)ct(e.id);else if(1===a)ct(e.id);else if(2===a){navigator.onLine||caches.open("SirvezApp").then((function(a){a.match("/api/floor/floorInfo?id="+N).then((function(e){return e?e.json():null})).then((function(t){if(null!=t){t.rooms=t.rooms.filter((function(t){return t.id!==e}));var n=new Response(JSON.stringify(t),{headers:{"content-type":"application/json"}});a.put("/api/floor/floorInfo?id="+N,n.clone()).then((function(){ot()}))}})),a.match("/api/building/buildingInfo?id="+t).then((function(e){return e?e.json():null})).then((function(n){if(null!=n){n.rooms=n.rooms.filter((function(t){return t.id!==e.id}));var o=new Response(JSON.stringify(n),{headers:{"content-type":"application/json"}});a.put("/api/building/buildingInfo?id="+t,o.clone()).then((function(){ot()}))}}))}));var n=new FormData;n.append("id",e.id),S.a.post(S.b+"siteroom/deleteRoom",n).then((function(e){"success"===e.data.status?(ot(),J.NotificationManager.info("You removed selected Room")):"error"===e.data.status&&J.NotificationManager.error(e.data.msg,"Error!",1e3,(function(){}))})).catch((function(e){J.NotificationManager.error(e,"Error!",1e3,(function(){}))}))}},it=function(){L(!1)},ct=function(e){Le(e),S.a.get(S.b+"siteroom/roomInfo",{params:{id:e}}).then((function(t){Ke(t.data.departments),e&&($e(t.data.room.department_id),Ve(t.data.room.room_number)),V(!0)})).catch((function(e){nt(!0)}))},st=function(){V(!1)};return l.a.createElement("div",{className:"app-wrapper"},l.a.createElement(r.a,{match:e.match,title:l.a.createElement(i.a,{id:"sidebar.sites.floorInfo"})}),ae?l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-12"},l.a.createElement("div",{className:"jr-card"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12"},l.a.createElement(v.a,{className:"icon-btn",onClick:function(){return le.go(-1)}},l.a.createElement("i",{className:"zmdi zmdi-arrow-left"})),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-xl-4 col-lg-4 col-md-6 col-sm-6 col-6 text-left"},l.a.createElement("h2",null,l.a.createElement("strong",null,"floor Name"))),l.a.createElement("div",{className:"col-xl-8 col-lg-8 col-md-6 col-sm-6 col-6 text-left"},l.a.createElement("h2",null,Oe.floor_name)))),l.a.createElement("div",{className:"col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 text-center my-2"},l.a.createElement("img",{className:"rounded-xl",style:{width:"100%",height:"auto"},src:S.c+"upload/img/"+Oe.upload_img,alt:Oe.floor_name})),l.a.createElement("ul",{className:"list-inline d-sm-flex flex-sm-row d-flex flex-row jr-mbtn-list mb-0 jr-featured-content-right"},l.a.createElement("li",null,l.a.createElement(P.a,{color:"primary",onClick:function(){return e=N,void S.a.get(S.b+"floor/getFloorInfo",{params:{id:e}}).then((function(t){e&&(je(t.data.floor.floor_name),Me(t.data.floor.upload_img?S.c+"upload/img/"+t.data.floor.upload_img:"https://via.placeholder.com/300x300")),L(!0)})).catch((function(e){nt(!0)}));var e},variant:"contained",className:"jr-btn text-white"},l.a.createElement(i.a,{id:"button.modify"}))),l.a.createElement("li",null,l.a.createElement(P.a,{color:"secondary",onClick:function(){return function(e){navigator.onLine||caches.open("SirvezApp").then((function(a){a.match("/api/building/buildingInfo?id="+t).then((function(e){return e?e.json():null})).then((function(n){if(null!=n){n.floors=n.floors.filter((function(t){return t.id!==e}));var o=new Response(JSON.stringify(n),{headers:{"content-type":"application/json"}});a.put("/api/building/buildingInfo?id="+t,o.clone()).then((function(){le.go(-1)}))}}))}));var a=new FormData;a.append("id",e),S.a.post(S.b+"floor/deleteFloor",a).then((function(e){"success"===e.data.status?le.push({pathname:"/app/sites/site/building",state:{}}):"error"===e.data.status&&J.NotificationManager.error(e.data.msg,"Error!",1e3,(function(){}))})).catch((function(e){J.NotificationManager.error(e,"Error!",1e3,(function(){}))}))}()},variant:"contained",className:"jr-btn text-white"},l.a.createElement(i.a,{id:"button.delete"}))))))),l.a.createElement("div",{className:"col-12"},l.a.createElement("div",{className:"jr-card"},l.a.createElement("div",null,l.a.createElement(h.a,{className:"table-header"},l.a.createElement("div",{className:"title"},l.a.createElement(b.a,{variant:"h6"},"Rooms")),l.a.createElement("div",{className:"col-md-3 col-lg-3 col-sx-6 col-6 ml-auto"},l.a.createElement(_.a,{placeholder:"Search ...",onChange:function(e){return t=e.target.value,void Ae(he.filter((function(e){return e.room_number.toLowerCase().includes(t.toLowerCase())})));var t}})),l.a.createElement("div",{className:"actions"},l.a.createElement(E.a,{title:"New Room"},l.a.createElement(v.a,{"aria-label":"New Room",onClick:function(){return ct(null)}},l.a.createElement(j.a,null))))),ae?l.a.createElement("div",{className:"flex-auto"},l.a.createElement("div",{className:"table-responsive-material"},l.a.createElement(c.a,{className:""},l.a.createElement(u.a,null,l.a.createElement(p.a,null,T.map((function(e){return l.a.createElement(m.a,{key:e.id,align:e.numeric},l.a.createElement(E.a,{title:"Sort",placement:e.numeric?"bottom-end":"bottom-start",enterDelay:300},l.a.createElement(g.a,{active:Z===e.id,direction:q,onClick:(t=e.id,function(e){lt(e,t)})},e.label)));var t})))),l.a.createElement(s.a,null,Je.length>0?Je.slice(ce*ue,ce*ue+ue).map((function(e){return l.a.createElement(p.a,{hover:!0,key:e.id,tabIndex:-1},l.a.createElement(m.a,null,e.id),l.a.createElement(m.a,null,e.room_number),l.a.createElement(m.a,null,e.department_name),l.a.createElement(m.a,{className:"text-right"},l.a.createElement(w.a,{key:e.id,selectedData:e,onSelectRow:rt})))})):l.a.createElement("tr",null,l.a.createElement("td",{className:"text-danger",colSpan:"4"},l.a.createElement(i.a,{id:"table.noData"})))),l.a.createElement(d.a,null,l.a.createElement(p.a,null,l.a.createElement(f.a,{count:Je.length,rowsPerPage:ue,page:ce,onChangePage:function(e,t){se(t)},onChangeRowsPerPage:function(e){fe(e.target.value)}}))))),l.a.createElement(J.NotificationContainer,null)):l.a.createElement("div",{className:"loader-view",style:{height:oe>=1200?"calc(100vh - 259px)":"calc(100vh - 238px)"}},l.a.createElement(x.a,null)),l.a.createElement(C.a,{key:"room-save",className:"modal-box",toggle:st,isOpen:H},l.a.createElement(k.a,null,Be?"Modify Room":"Add Room",l.a.createElement(v.a,{className:"text-grey",onClick:st},l.a.createElement(I.a,null))),l.a.createElement("div",{className:"modal-box-content"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6 col-12"},l.a.createElement(D.a,{id:"room_department",select:!0,label:"department",value:Ze,onChange:function(e){return $e(e.target.value)},SelectProps:{},helperText:"Please select Department",margin:"normal",fullWidth:!0},qe.map((function(e){return l.a.createElement(M.a,{key:e.id,value:e.id},e.department_name)})))),l.a.createElement("div",{className:"col-md-6 col-12"},l.a.createElement(D.a,{id:"room_number",label:"Room Number",value:He,onChange:function(e){return Ve(e.target.value)},margin:"normal",helperText:"Please Enter Room Number",fullWidth:!0})))),l.a.createElement("div",{className:"modal-box-footer d-flex flex-row jr-featured-content-right"},l.a.createElement(P.a,{onClick:st,color:"secondary",variant:"contained",className:"jr-btn text-white"},"Cancel"),l.a.createElement(P.a,{onClick:function(){var e=Be||JSON.parse(localStorage.getItem("user")).id+"_"+(new Date).getTime();st();var n=new FormData;n.append("id",Be),n.append("site_id",a),n.append("department_id",Ze),n.append("building_id",t),n.append("floor_id",N),n.append("room_number",He),S.a.post(S.b+"siteroom/updateRoom",n).then((function(e){"success"===e.data.status?(J.NotificationManager.success("Updated room!","Success!",1e3,(function(){})),ot()):"error"===e.data.status&&J.NotificationManager.error(e.data.msg,"Error!",1e3,(function(){}))})).catch((function(e){J.NotificationManager.error(e,"Error!",1e3,(function(){}))})),navigator.onLine||caches.open("SirvezApp").then((function(n){var o={id:e,site_id:a,department_id:Ze,building_id:t,floor_id:N,room_number:He},l={room:o,status:"success"},r=new Response(JSON.stringify(l),{headers:{"content-type":"application/json"}});n.put("/api/room/getRoomInfo?id="+e,r.clone()),n.match("/api/building/buildingInfo?id="+t).then((function(e){return e?e.json():null})).then((function(l){if(null!=l){var r=l.floors.find((function(t){return t.id===e}));r?(r.site_id=a,r.department_id=Ze,r.building_id=t,r.floor_id=N,r.room_number=He):l.rooms.unshift(o);var i=new Response(JSON.stringify(l),{headers:{"content-type":"application/json"}});n.put("/api/building/buildingInfo?id="+t,i.clone()).then((function(){ot()}))}}))}))},color:"primary",variant:"contained",className:"jr-btn text-white"},"Save"))),l.a.createElement(C.a,{key:"floor-save",className:"modal-box",toggle:it,isOpen:B},l.a.createElement(k.a,null,N?"Modify floor":"Add Floor",l.a.createElement(v.a,{className:"text-grey",onClick:it},l.a.createElement(I.a,null))),l.a.createElement("div",{className:"modal-box-content"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-xl-3 col-lg-4 col-md-5 col-12"},l.a.createElement("div",{className:"jr-card pb-2"},l.a.createElement("div",{className:"jr-card-thumb"},l.a.createElement("img",{className:"card-img-top img-fluid",alt:"products",src:De})),l.a.createElement("input",{type:"file",id:"upload_img",accept:"image/*",name:"upload_img",style:{display:"none"},onChange:function(e){return function(e){e.preventDefault();var t=new FileReader,a=e.target.files[0];t.onloadend=function(){ke(a),Me(t.result)},t.readAsDataURL(a)}(e)}}),l.a.createElement("div",{className:"jr-card-social text-right"},l.a.createElement(z.a,{className:"jr-fab-btn bg-secondary text-white jr-btn-fab-xs mb-3",onClick:function(e){document.getElementById("upload_img").click()}},l.a.createElement("i",{className:"zmdi zmdi-cloud-upload zmdi-hc-1x"}))))),l.a.createElement("div",{className:"col-xl-9 col-lg-8 col-md-7 col-12"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6 col-12"},l.a.createElement(D.a,{id:"floor_name",label:"Floor",value:Ne,onChange:function(e){return je(e.target.value)},margin:"normal",helperText:"Please Enter Floor",fullWidth:!0})),l.a.createElement("div",{className:"modal-box-footer d-flex flex-row jr-featured-content-right"},l.a.createElement(P.a,{onClick:it,color:"secondary",variant:"contained",className:"jr-btn text-white"},"Cancel"),l.a.createElement(P.a,{onClick:function(){it();var e=N||JSON.parse(localStorage.getItem("user")).id+"_"+(new Date).getTime(),n=new FormData;n.append("id",e),n.append("site_id",a),n.append("building_id",t),n.append("floor_name",Ne),n.append("upload_img",Ce),S.a.post(S.b+"floor/updateFloor",n).then((function(e){"success"===e.data.status?(J.NotificationManager.success("Updated floor!","Success!",1e3,(function(){})),ot()):"error"===e.data.status&&J.NotificationManager.error(e.data.msg,"Error!",1e3,(function(){}))})).catch((function(e){J.NotificationManager.error(e,"Error!",1e3,(function(){}))})),navigator.onLine||caches.open("SirvezApp").then((function(n){var o="";Ce&&(o=(new Date).getTime()+"_new.jpeg",n.put("/upload/img/"+o,new Response(Ce)));var l={id:e,site_id:a,building_id:t,floor_name:Ne,rooms_count:0};""!==o&&(l.upload_img=o);var r={floor:l,status:"success"},i=new Response(JSON.stringify(r),{headers:{"content-type":"application/json"}});n.put("/api/floor/getFloorInfo?id="+e,i.clone()),n.match("/api/floor/floorInfo?id="+e).then((function(e){return e?e.json():null})).then((function(t){if(null==t){t={floor:l,status:"success",rooms:[]};var a=new Response(JSON.stringify(t),{headers:{"content-type":"application/json"}});n.put("/api/floor/floorInfo?id="+e,a.clone())}else{t.floor=l;var o=new Response(JSON.stringify(t),{headers:{"content-type":"application/json"}});n.put("/api/floor/floorInfo?id="+e,o.clone())}})),n.match("/api/building/buildingInfo?id="+t).then((function(e){return e?e.json():null})).then((function(r){if(null!=r){var i=r.floors.find((function(t){return t.id===e}));i?(i.site_id=a,i.building_id=t,i.floor_name=Ne,""!==o&&(i.upload_img=o)):r.floors.unshift(l);var c=new Response(JSON.stringify(r),{headers:{"content-type":"application/json"}});n.put("/api/building/buildingInfo?id="+t,c.clone()).then((function(){ot()}))}}))}))},color:"primary",variant:"contained",className:"jr-btn text-white"},"Save"))))))))))):l.a.createElement("div",{className:"loader-view",style:{height:oe>=1200?"calc(100vh - 259px)":"calc(100vh - 238px)"}},l.a.createElement(x.a,null)),l.a.createElement(F.a,{show:at,warning:!0,confirmBtnText:"Go Back",confirmBtnBsStyle:"danger",cancelBtnBsStyle:"default",title:"Warning!",onConfirm:function(){return le.go(-1)}},"Data not cached, so you can not view this page."))}},480:function(e,t,a){"use strict";var n=a(0),o=a.n(n),l=a(529),r=a(530),i=function(e,t,a){return 0===a?"/":"/"+e.split(t)[0]+t};t.a=function(e){var t=e.title,a=e.match,n=e.project_name,c=e.room_number,s=[],m=a.url.substr(1),d=m.split("/");return d.map((function(e,t){""===e&&d.splice(t,1),"live"===d[t-1]?s[t]=n||"":"live"===d[t-2]?s[t]=c||"":s[t]=e})),o.a.createElement("div",{className:"page-heading d-sm-flex justify-content-sm-between align-items-sm-center"},o.a.createElement("h2",{className:"title mb-3 mb-sm-0"},t),o.a.createElement(l.a,{className:"mb-0",tag:"nav"},d.map((function(e,t){if(0!=t)return o.a.createElement(r.a,{active:d.length===t+1,tag:d.length===t+1?"span":"a",key:t,href:i(m,e,t)},function(e){var t=e.split("-");return t.length>1?t[0].charAt(0).toUpperCase()+t[0].slice(1)+" "+t[1].charAt(0).toUpperCase()+t[1].slice(1):e.charAt(0).toUpperCase()+e.slice(1)}(s[t]))}))))}},532:function(e,t,a){"use strict";var n=a(41);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n(a(0)),l=(0,n(a(173)).default)(o.default.createElement("path",{d:"M14 10H2v2h12v-2zm0-4H2v2h12V6zm4 8v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zM2 16h8v-2H2v2z"}),"PlaylistAdd");t.default=l},851:function(e,t,a){"use strict";var n=a(9),o=a(0),l=a.n(o),r=a(252),i=a(448),c=a(404);t.a=function(e){var t=Object(o.useState)(!1),a=Object(n.a)(t,2),s=a[0],m=a[1],d=Object(o.useState)(void 0),u=Object(n.a)(d,2),f=u[0],p=u[1],g=e.selectedData,h=e.onSelectRow,b=e.menu_rows,v=b||[{content:"View",id:0},{content:"Modify",id:1},{content:"Delete",id:2}],E=function(){m(!1)};return l.a.createElement("div",null,l.a.createElement(c.a,{onClick:function(e){m(!0),p(e.currentTarget)}},l.a.createElement("i",{className:"zmdi zmdi-more-vert"})),l.a.createElement(r.a,{anchorEl:f,open:s,onClose:E,key:g.id,MenuListProps:{style:{width:150,paddingTop:0,paddingBottom:0}}},v.map((function(e){return l.a.createElement(i.a,{key:g+"-"+e.content,onClick:function(){E(),h(g,e.id)}},e.content)}))))}}}]);
//# sourceMappingURL=60.9e9ec67f.chunk.js.map