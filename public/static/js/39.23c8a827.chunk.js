(this["webpackJsonpjumbo-hooks"]=this["webpackJsonpjumbo-hooks"]||[]).push([[39],{1258:function(e,t,a){"use strict";a.r(t);var n=a(32),c=a.n(n),r=a(105),o=a(9),i=a(0),l=a.n(i),s=a(29),m=a(50),u=a(480),d=a(3),p=a(487),h=a(891),g=a(445),f=a(467),b=a(448),v=a(27),y=a(14),j=a(446),E=a(447),O=a(490),N=a.n(O),w=a(499),S=a.n(w);t.default=function(e){var t=Object(v.g)(),a=e.location.state?e.location.state.id:null,n=Object(i.useState)(!1),O=Object(o.a)(n,2),w=O[0],k=O[1],_=Object(i.useState)(""),C=Object(o.a)(_,2),x=C[0],P=C[1],z=Object(i.useState)(""),M=Object(o.a)(z,2),T=M[0],I=M[1],R=Object(i.useState)(""),A=Object(o.a)(R,2),B=A[0],W=A[1],J=Object(i.useState)(""),L=Object(o.a)(J,2),U=L[0],D=L[1],H=Object(i.useState)(""),F=Object(o.a)(H,2),G=F[0],V=F[1],$=Object(i.useState)(""),q=Object(o.a)($,2),K=q[0],Q=q[1],X=Object(i.useState)(""),Y=Object(o.a)(X,2),Z=Y[0],ee=Y[1],te=Object(i.useState)(!e.location.state),ae=Object(o.a)(te,2),ne=ae[0],ce=ae[1],re=Object(i.useState)(null),oe=Object(o.a)(re,2),ie=oe[0],le=oe[1],se=Object(y.e)((function(e){return e.settings})).width,me=Object(i.useState)("https://via.placeholder.com/300x300"),ue=Object(o.a)(me,2),de=ue[0],pe=ue[1],he=Object(i.useState)([]),ge=Object(o.a)(he,2),fe=ge[0],be=ge[1],ve=Object(i.useState)(!1),ye=Object(o.a)(ve,2),je=ye[0],Ee=ye[1];Object(i.useEffect)((function(){s.a.get(s.b+"customers/company/customer-edit",{params:{id:a}}).then((function(e){e.data.company&&(P(e.data.company.name),I(e.data.company.manager),W(e.data.company.website),D(e.data.company.company_email),V(e.data.company.address),Q(e.data.company.city),ee(e.data.company.postcode),pe(e.data.company.logo_img?s.c+"upload/img/"+e.data.company.logo_img:"https://via.placeholder.com/300x300")),be(e.data.account_manager),k(!0)})).catch((function(e){Ee(!0)}))}),[a]);var Oe=function(e){return new Promise((function(t){S.a.imageFileResizer(e,500,500,"JPEG",100,0,(function(e){t(e)}),"blob")}))},Ne=function(){var e=Object(r.a)(c.a.mark((function e(t){var a,n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a=t.target.files[0],e.next=4,Oe(a);case 4:n=e.sent,r=a.name,a=new File([n],r,n),le(a),pe(URL.createObjectURL(a));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return l.a.createElement("div",{className:"app-wrapper"},l.a.createElement(u.a,{match:e.match,title:l.a.createElement(d.a,{id:"sidebar.customers.company"})}),w?l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-xl-3 col-lg-4 col-md-5 col-12"},l.a.createElement("div",{className:"jr-card pb-2"},l.a.createElement("div",{className:"jr-card-thumb"},l.a.createElement("img",{className:"card-img-top img-fluid",alt:"products",src:de})),l.a.createElement("input",{type:"file",id:"logo_img",accept:"image/*",name:"logo_img",style:{display:"none"},onChange:function(e){Ne(e)}}),l.a.createElement("div",{className:"jr-card-social text-right"},l.a.createElement(g.a,{className:"jr-btn text-primary"},"Company Logo"),l.a.createElement(E.a,{className:"jr-fab-btn bg-light-blue accent-2 text-white",onClick:function(e){document.getElementById("logo_img").click()}},l.a.createElement("i",{className:"zmdi zmdi-cloud-upload zmdi-hc-2x"}))))),l.a.createElement(p.a,{styleName:"col-xl-9 col-lg-8 col-md-7 col-12"},l.a.createElement("form",{className:"row",autoComplete:"off"},l.a.createElement("div",{className:"col-md-6 col-12"},l.a.createElement(f.a,{id:"name",label:"Company Name",value:x,onChange:function(e){return P(e.target.value)},margin:"normal",helperText:"Please Enter Company Name",fullWidth:!0})),l.a.createElement("div",{className:"col-md-6 col-12"},l.a.createElement(f.a,{id:"account_manager",select:!0,label:"Account Manager",value:T,onChange:function(e){return I(e.target.value)},SelectProps:{},helperText:"Please select Account Manager",margin:"normal",fullWidth:!0},fe&&fe.length>0?fe.map((function(e){return l.a.createElement(b.a,{key:e.id,value:e.id},e.first_name," ",e.last_name)})):"")),l.a.createElement("div",{className:"col-md-6 col-12"},l.a.createElement(f.a,{id:"website",label:"Website Url",value:B,onChange:function(e){return W(e.target.value)},margin:"normal",helperText:"Please Enter Website",fullWidth:!0})),l.a.createElement("div",{className:"col-md-6 col-12"},l.a.createElement(f.a,{id:"company_email",label:"Company Email",value:U,onChange:function(e){return D(e.target.value)},margin:"normal",helperText:"Please Enter Company Email",fullWidth:!0})),l.a.createElement("div",{className:"col-md-6 col-12"},l.a.createElement(f.a,{id:"address",label:"Address",value:G,onChange:function(e){return V(e.target.value)},margin:"normal",helperText:"Please Enter Address",fullWidth:!0})),l.a.createElement("div",{className:"col-md-6 col-12"},l.a.createElement(f.a,{id:"city",label:"City",value:K,onChange:function(e){return Q(e.target.value)},margin:"normal",helperText:"Please Enter City",fullWidth:!0})),l.a.createElement("div",{className:"col-md-6 col-12"},l.a.createElement(f.a,{id:"postcode",label:"Postcode",value:Z,onChange:function(e){return ee(e.target.value)},margin:"normal",helperText:"Please Enter Postcode",fullWidth:!0})),a>0||l.a.createElement("div",{className:"d-flex align-items-center"},l.a.createElement(h.a,{id:"is_site",color:"primary",checked:ne,onChange:function(e){return ce(e.target.checked)}}),l.a.createElement("span",null,"Create Site customer address")),l.a.createElement("div",{className:"col-md-12 col-12 text-right"},l.a.createElement(g.a,{variant:"contained",color:"primary",className:"jr-btn",onClick:function(){return function(){var e=a>0?a:JSON.parse(localStorage.getItem("user")).first_name+"_"+(new Date).getTime(),n=JSON.parse(localStorage.getItem("user")).first_name+"_"+(new Date).getTime();navigator.onLine||caches.open("SirvezApp").then((function(t){var c="";ie&&(c=(new Date).getTime()+"_new.jpeg",t.put("/upload/img/"+c,new Response(ie)));var r={id:e,site_off_id:n,name:x,city:K,postcode:Z,company_email:U,address:G,logo_img:c,manager:T,website:B,project_count:0,room_count:0,site_count:ne?1:0,user_count:0};t.match("/api/customers/company/customer-edit").then((function(e){return e?e.json():null})).then((function(a){if(null!=a){a.company=r;var n=new Response(JSON.stringify(a),{headers:{"content-type":"application/json"}});t.put("/api/customers/company/customer-edit?id="+e,n.clone())}}));t.match("/api/customers/company").then((function(e){return e?e.json():null})).then((function(a){if(null!=a){var n=a.customers.find((function(t){return t.id===e}));n?(n.name=x,n.city=K,n.postcode=Z,n.company_email=U,n.address=G,n.manager=T,n.website=B,""!==c&&(n.logo_img=c)):a.customers.unshift(r);var o=new Response(JSON.stringify(a),{headers:{"content-type":"application/json"}});t.put("/api/customers/company",o.clone())}}));var o={company:r,projects:[],rooms:[],sites:[],status:"success",tasks:[],users:[]};if(a>0)t.match("/api/customers/companyInfo?id="+a).then((function(e){return e.json()})).then((function(e){o.projects=e.projects,o.rooms=e.rooms,o.sites=e.sites,o.tasks=e.tasks,o.users=e.users}));else if(ne){var i={id:n,company_id:e,site_name:x+"Head Office",address:G,city:K,postcode:Z,rooms:0,projects:0},l={site:i},s=new Response(JSON.stringify(l),{headers:{"content-type":"application/json"},method:"GET"});t.put("/api/site/siteInfo?id="+n,s.clone()),o.sites[0]=i}var m=new Response(JSON.stringify(o),{headers:{"content-type":"application/json"},method:"GET"});t.put("/api/customers/companyInfo?id="+e,m.clone());var u="/api/task/taskList?customer_id="+e;a||t.match("/api/task/taskList").then((function(e){return e?e.json():null})).then((function(a){if(null!=a){a.project_id="",a.customerId=e,a.tasks=[];var n=new Response(JSON.stringify(a),{headers:{"content-type":"application/json"}});t.put(u,n.clone())}})).catch((function(e){var a=new Response(JSON.stringify({customers:[],projects:[],status:"success",tasks:[],users:[]}),{headers:{"content-type":"application/json"}});t.put(u,a.clone())}))})).catch((function(e){console.log("cashe_error",e)}));var c=new FormData;c.append("id",e),c.append("site_off_id",n),c.append("company_name",x),c.append("logo_img",ie),c.append("website",B),c.append("company_email",U),c.append("address",G),c.append("city",K),c.append("postcode",Z),c.append("is_site",ne),c.append("manager",T),s.a.post(s.b+"customers/company/customer-edit",c).then((function(e){"success"===e.data.status?t.go(-1):"error"===e.data.status&&m.NotificationManager.error(e.data.msg,"Error!",1e3,(function(){alert("callback")}))})).catch((function(e){m.NotificationManager.error(e,"Error!",1e3,(function(){}))}))}()}},"Save"))))):l.a.createElement("div",{className:"loader-view",style:{height:se>=1200?"calc(100vh - 259px)":"calc(100vh - 238px)"}},l.a.createElement(j.a,null)),l.a.createElement(N.a,{show:je,warning:!0,confirmBtnText:"Go Back",confirmBtnBsStyle:"danger",cancelBtnBsStyle:"default",title:"Warning!",onConfirm:function(){return t.go(-1)}},"Data not cached, so you can not view this page."),l.a.createElement(m.NotificationContainer,null))}},480:function(e,t,a){"use strict";var n=a(0),c=a.n(n),r=a(529),o=a(530),i=function(e,t,a){return 0===a?"/":"/"+e.split(t)[0]+t};t.a=function(e){var t=e.title,a=e.match,n=e.project_name,l=e.room_number,s=[],m=a.url.substr(1),u=m.split("/");return u.map((function(e,t){""===e&&u.splice(t,1),"live"===u[t-1]?s[t]=n||"":"live"===u[t-2]?s[t]=l||"":s[t]=e})),c.a.createElement("div",{className:"page-heading d-sm-flex justify-content-sm-between align-items-sm-center"},c.a.createElement("h2",{className:"title mb-3 mb-sm-0"},t),c.a.createElement(r.a,{className:"mb-0",tag:"nav"},u.map((function(e,t){if(0!=t)return c.a.createElement(o.a,{active:u.length===t+1,tag:u.length===t+1?"span":"a",key:t,href:i(m,e,t)},function(e){var t=e.split("-");return t.length>1?t[0].charAt(0).toUpperCase()+t[0].slice(1)+" "+t[1].charAt(0).toUpperCase()+t[1].slice(1):e.charAt(0).toUpperCase()+e.slice(1)}(s[t]))}))))}},487:function(e,t,a){"use strict";var n=a(0),c=a.n(n),r=function(e){var t=e.heading,a=e.children,n=e.styleName,r=e.cardStyle,o=e.childrenStyle,i=e.headerOutside,l=e.headingStyle;return c.a.createElement("div",{className:"".concat(n)},i&&c.a.createElement("div",{className:"jr-entry-header"},c.a.createElement("h3",{className:"entry-heading"},t),a.length>1&&c.a.createElement("div",{className:"entry-description"},a[0])),c.a.createElement("div",{className:"jr-card ".concat(r)},!i&&t&&c.a.createElement("div",{className:"jr-card-header ".concat(l)},c.a.createElement("h3",{className:"card-heading"},t),a.length>1&&c.a.createElement("div",{className:"sub-heading"},a[0])),c.a.createElement("div",{className:"jr-card-body ".concat(o)},a.length>1?a[1]:a)))};t.a=r,r.defaultProps={cardStyle:"",headingStyle:"",childrenStyle:"",styleName:"col-lg-6 col-sm-12"}},499:function(e,t){e.exports=function(e){var t={};function a(n){if(t[n])return t[n].exports;var c=t[n]={i:n,l:!1,exports:{}};return e[n].call(c.exports,c,c.exports,a),c.l=!0,c.exports}return a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var c in e)a.d(n,c,function(t){return e[t]}.bind(null,c));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=0)}([function(e,t,a){"use strict";function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}a.r(t);var c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,a;return t=e,a=[{key:"changeHeightWidth",value:function(e,t,a,n,c,r){return a>n&&(e=Math.round(e*n/a),a=n),e>t&&(a=Math.round(a*t/e),e=t),c&&a<c&&(e=Math.round(e*c/a),a=c),r&&e<r&&(a=Math.round(a*r/e),e=r),{height:e,width:a}}},{key:"resizeAndRotateImage",value:function(e,t,a,n,c){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"jpeg",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:100,i=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=o/100,s=document.createElement("canvas"),m=e.width,u=e.height,d=this.changeHeightWidth(u,a,m,t,n,c);!i||90!==i&&270!==i?(s.width=d.width,s.height=d.height):(s.width=d.height,s.height=d.width),m=d.width,u=d.height;var p=s.getContext("2d");return i&&(p.rotate(i*Math.PI/180),90===i?p.translate(0,-s.width):180===i?p.translate(-s.width,-s.height):270===i?p.translate(-s.height,0):0!==i&&360!==i||p.translate(0,0)),p.drawImage(e,0,0,m,u),s.toDataURL("image/".concat(r),l)}},{key:"b64toBlob",value:function(e,t){t=t||"image/jpeg";for(var a=atob(e.toString().replace(/^data:image\/(png|jpeg|jpg);base64,/,"")),n=[],c=0;c<a.length;c+=512){for(var r=a.slice(c,c+512),o=new Array(r.length),i=0;i<r.length;i++)o[i]=r.charCodeAt(i);var l=new Uint8Array(o);n.push(l)}return new Blob(n,{type:t})}},{key:"createResizedImage",value:function(t,a,n,c,r,o,i){var l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"base64",s=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,m=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,u=null,d=new FileReader;t?(d.readAsDataURL(t),d.onload=function(){var t=new Image;t.src=d.result,t.onload=function(){var d=e.resizeAndRotateImage(t,a,n,s,m,c,r,o);u=e.b64toBlob(d,"image/".concat(c)),i("blob"===l?u:d)}},d.onerror=function(e){i(e)}):i("File Not Found")}}],null&&n(t.prototype,null),a&&n(t,a),e}();t.default={imageFileResizer:function(e,t,a,n,r,o,i,l,s,m){return c.createResizedImage(e,t,a,n,r,o,i,l,s,m)}}}])},529:function(e,t,a){"use strict";var n=a(1),c=a(22),r=a(0),o=a.n(r),i=a(2),l=a.n(i),s=a(54),m=a.n(s),u=a(18),d={tag:u.m,listTag:u.m,className:l.a.string,listClassName:l.a.string,cssModule:l.a.object,children:l.a.node,"aria-label":l.a.string},p=function(e){var t=e.className,a=e.listClassName,r=e.cssModule,i=e.children,l=e.tag,s=e.listTag,d=e["aria-label"],p=Object(c.a)(e,["className","listClassName","cssModule","children","tag","listTag","aria-label"]),h=Object(u.i)(m()(t),r),g=Object(u.i)(m()("breadcrumb",a),r);return o.a.createElement(l,Object(n.a)({},p,{className:h,"aria-label":d}),o.a.createElement(s,{className:g},i))};p.propTypes=d,p.defaultProps={tag:"nav",listTag:"ol","aria-label":"breadcrumb"},t.a=p},530:function(e,t,a){"use strict";var n=a(1),c=a(22),r=a(0),o=a.n(r),i=a(2),l=a.n(i),s=a(54),m=a.n(s),u=a(18),d={tag:u.m,active:l.a.bool,className:l.a.string,cssModule:l.a.object},p=function(e){var t=e.className,a=e.cssModule,r=e.active,i=e.tag,l=Object(c.a)(e,["className","cssModule","active","tag"]),s=Object(u.i)(m()(t,!!r&&"active","breadcrumb-item"),a);return o.a.createElement(i,Object(n.a)({},l,{className:s,"aria-current":r?"page":void 0}))};p.propTypes=d,p.defaultProps={tag:"li"},t.a=p},891:function(e,t,a){"use strict";var n=a(1),c=a(6),r=a(0),o=(a(2),a(5)),i=a(127),l=a(55),s=Object(l.a)(r.createElement("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank"),m=Object(l.a)(r.createElement("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox"),u=a(31),d=Object(l.a)(r.createElement("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}),"IndeterminateCheckBox"),p=a(12),h=a(8),g=r.createElement(m,null),f=r.createElement(s,null),b=r.createElement(d,null),v=r.forwardRef((function(e,t){var a=e.checkedIcon,l=void 0===a?g:a,s=e.classes,m=e.color,u=void 0===m?"secondary":m,d=e.icon,h=void 0===d?f:d,v=e.indeterminate,y=void 0!==v&&v,j=e.indeterminateIcon,E=void 0===j?b:j,O=e.inputProps,N=e.size,w=void 0===N?"medium":N,S=Object(c.a)(e,["checkedIcon","classes","color","icon","indeterminate","indeterminateIcon","inputProps","size"]),k=y?E:h,_=y?E:l;return r.createElement(i.a,Object(n.a)({type:"checkbox",classes:{root:Object(o.a)(s.root,s["color".concat(Object(p.a)(u))],y&&s.indeterminate),checked:s.checked,disabled:s.disabled},color:u,inputProps:Object(n.a)({"data-indeterminate":y},O),icon:r.cloneElement(k,{fontSize:void 0===k.props.fontSize&&"small"===w?w:k.props.fontSize}),checkedIcon:r.cloneElement(_,{fontSize:void 0===_.props.fontSize&&"small"===w?w:_.props.fontSize}),ref:t},S))}));t.a=Object(h.a)((function(e){return{root:{color:e.palette.text.secondary},checked:{},disabled:{},indeterminate:{},colorPrimary:{"&$checked":{color:e.palette.primary.main,"&:hover":{backgroundColor:Object(u.c)(e.palette.primary.main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"&$disabled":{color:e.palette.action.disabled}},colorSecondary:{"&$checked":{color:e.palette.secondary.main,"&:hover":{backgroundColor:Object(u.c)(e.palette.secondary.main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"&$disabled":{color:e.palette.action.disabled}}}}),{name:"MuiCheckbox"})(v)}}]);
//# sourceMappingURL=39.23c8a827.chunk.js.map